<?php 	//********************	//** WEB MIRACLE TECHNOLOGIES	//********************		// get post		$appTable = $_POST['appTable'];		$item_id = $_POST['item_id'];	$lpx = $_POST['lpx'];	$lang_prefix = ($lpx ? $lpx."_" : ""); // empty = iw	$cardUpd = array(			$lang_prefix.'name'		=> strip_tags(trim($_POST['name'])),			$lang_prefix.'desc'		=> trim($_POST['desc']),			'alias'					=> $_POST['alias'],			'show_on_about'			=> $_POST['show_on_about'][0],	);							$query = "SELECT id FROM [pre]$appTable WHERE `alias`='".$cardUpd['alias']."' AND `id`!=$item_id LIMIT 1";	$test_alias = $ah->rs($query);					if(strlen($cardUpd[$lang_prefix.'name'])>1)	{		if(!$test_alias)		{				$filename = "cover";					if(isset($_FILES[$filename]) && $_FILES[$filename]['size'] > 0)				{					$file_path = "../../../../public/img/content/";										$file_update = $ah->mtvc_add_files_file(array(							'path'			=>$file_path,							'name'			=>5,							'pre'			=>"page_",							'size'			=>10,							'rule'			=>0,							'max_w'			=>2500,							'max_h'			=>2500,							'files'			=>$filename						  ));					if($file_update)					{						$cardUpd[$filename] = $file_update;												$curr_filename = $_POST['curr_filename'];												unlink($file_path.$curr_filename);					}				}								$query = "UPDATE [pre]$appTable SET ";								$cntUpd = 0;				foreach($cardUpd as $field => $itemUpd)				{					$cntUpd++;					$query .= ($cntUpd==1 ? "`$field`='$itemUpd'" : ", `$field`='$itemUpd'");				}								$query .= " WHERE `id`=$item_id LIMIT 1";				$data['query'] = $query;				$ah->rs($query);				$data['message'] = "Раздел сохранен.";							}else{				$data['status'] = "failed";				$data['message'] = "Раздел с таким алиасом уже существует";			}	}else{		$data['status'] = "failed";		$data['message'] = "Укажите название проекта";	}		